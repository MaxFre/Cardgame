import"./modulepreload-polyfill-3cfb730f.js";import{A as J,a as D,T as F,i as K,C as q,G as Q,d as U}from"./BoardForrest-927fe922.js";import{c as V}from"./CardBack-419d7a67.js";let k={},I={};function w(t){return t==="opponent"?I:k}function P(t,n){n==="opponent"?I=t:k=t}const h=1280,p=720,O=52,c=new J({backgroundColor:1710638,antialias:!0,resolution:2,autoDensity:!0,width:h,height:p}),f=c.view;f.style.position="fixed";document.getElementById("app").appendChild(f);function R(){const t=window.innerWidth,n=window.innerHeight-O,o=Math.min(t/h,n/p),r=Math.round(h*o),i=Math.round(p*o);f.style.width=r+"px",f.style.height=i+"px",f.style.left=Math.round((t-r)/2)+"px",f.style.top=O+Math.round((n-i)/2)+"px"}window.addEventListener("resize",R);R();const Z=128,$=192,u=new D(F.from(K));u.anchor.set(0,0);u.alpha=.35;c.stage.addChild(u);const y=new q;c.stage.addChild(y);function B(){return h*.3}function H(t){return t==="opponent"?p*.13:p*.88}const a=new Q;c.stage.addChild(a);function W(t){const n=B(),o=H(t);a.clear(),a.lineStyle(1,16777215,.3),a.moveTo(n-14,o),a.lineTo(n+14,o),a.moveTo(n,o-14),a.lineTo(n,o+14),a.lineStyle(0),a.beginFill(16766720,.22),a.drawCircle(n,o,5),a.endFill()}window.addEventListener("resize",()=>{u.width=h,u.height=p,W(s)});u.width=h;u.height=p;function tt(t){const n=Math.min(145,870/Math.max(t-1,1)),o=(t-1)/2;return Array.from({length:t},(r,i)=>{const l=i-o;return{x:l*n,y:Math.abs(l)*6,r:l*6*Math.PI/180}})}let E=null;async function Y(){try{await fetch("/api/save-hand-layout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({handSlots:w("player"),opponentHandSlots:w("opponent"),...E?{handLayoutConfig:E}:{}})})}catch{}}(async function(){try{const n=await fetch("/CreatedCards/layout.json?t="+Date.now());if(!n.ok)return;const o=await n.json();o.handSlots&&(k=o.handSlots),o.opponentHandSlots&&(I=o.opponentHandSlots),o.handLayoutConfig&&(E=o.handLayoutConfig),b()}catch{}})();let S=5,s="player",L=[],d=null,G=0,j=0;c.stage.eventMode="static";c.stage.on("pointermove",t=>{d&&(d.x=t.global.x-G,d.y=t.global.y-j)});c.stage.on("pointerup",()=>{d=null});c.stage.on("pointerupoutside",()=>{d=null});let v=null;window.addEventListener("wheel",t=>{if(!v)return;t.preventDefault();const n=t.shiftKey?.005:.02,o=s==="opponent"?-1:1;v.rotation+=o*(t.deltaY>0?n:-n)},{passive:!1});function et(t,n){y.removeChildren(),L=[];const o=w(n)[String(t)]??tt(t),r=B(),i=H(n),l=n==="opponent"?-1:1;for(let g=0;g<t;g++){const m=o[g]??{x:0,y:0,r:0},e=new D(F.from(V));e.anchor.set(.5);const A=()=>{const x=e.texture.width||1,X=e.texture.height||1;e.scale.x=Z/x,e.scale.y=$/X*l};e.texture.baseTexture.valid?A():e.texture.baseTexture.once("loaded",A),e.x=r+m.x,e.y=i+m.y*l,e.rotation=(m.r??0)*l,e.eventMode="static",e.cursor="grab",e.zIndex=g;const C=new U(String(g+1),{fontFamily:"Arial",fontSize:18,fill:16766720,stroke:0,strokeThickness:3});C.anchor.set(.5),C.scale.y=l,e.addChild(C),e.on("pointerdown",x=>{d=e,v=e,G=x.global.x-e.x,j=x.global.y-e.y,e.cursor="grabbing",y.setChildIndex(e,y.children.length-1),x.stopPropagation()}),e.on("pointerup",()=>{e.cursor="grab"}),e.on("pointerupoutside",()=>{e.cursor="grab"}),e.on("pointerover",()=>{e!==d&&(v=e)}),y.addChild(e),L.push(e)}y.sortableChildren=!0}function nt(t){const n=B(),o=H(t),r=t==="opponent"?-1:1;return L.map(i=>({x:Math.round(i.x-n),y:Math.round((i.y-o)*r),r:+(i.rotation*r).toFixed(4)}))}function b(){et(S,s),W(s),v=null}const _=document.getElementById("sizeSelect"),ot=document.getElementById("btnSave"),at=document.getElementById("btnReset"),z=document.getElementById("savedBadge"),T=document.getElementById("btnPlayer"),M=document.getElementById("btnOpponent");_.addEventListener("change",()=>{S=parseInt(_.value,10),b()});function N(t){s=t,T.style.background=t==="player"?"#4f6ef7":"#222",T.style.color=t==="player"?"#fff":"#aaa",M.style.background=t==="opponent"?"#ef4444":"#222",M.style.color=t==="opponent"?"#fff":"#aaa",b()}T.addEventListener("click",()=>N("player"));M.addEventListener("click",()=>N("opponent"));ot.addEventListener("click",async()=>{const t=w(s);t[String(S)]=nt(s),P(t,s),await Y(),z.style.opacity="1",setTimeout(()=>z.style.opacity="0",1600)});at.addEventListener("click",async()=>{const t=w(s);delete t[String(S)],P(t,s),await Y(),b()});b();
