import"./modulepreload-polyfill-3cfb730f.js";import{a as h,S as c}from"./SoundManager-7983c1fd.js";const g={hit:{name:"Attack Hit",desc:"Plays on clash when two minions collide.",icon:"âš”ï¸",color:"#ef4444"},death:{name:"Card Death",desc:"Plays when a minion dies and fades out.",icon:"ğŸ’€",color:"#7c3aed"},summon:{name:"Summon",desc:"Plays when a minion is placed on the field.",icon:"âœ¨",color:"#3b82f6"},draw:{name:"Draw Card",desc:"Plays each time a card is drawn from the deck.",icon:"ğŸƒ",color:"#10b981"},endTurn:{name:"End Turn",desc:"Plays when the End Turn button is clicked.",icon:"â­ï¸",color:"#f59e0b"},battlecry:{name:"Battlecry",desc:"Plays when a battlecry triggers on summon.",icon:"ğŸ“£",color:"#f97316"},morale:{name:"Morale Change",desc:"Plays on morale gain or drain effects.",icon:"ğŸ³ï¸",color:"#ec4899"},heal:{name:"Heal",desc:"Plays when a friendly minion is healed.",icon:"ğŸ’š",color:"#22c55e"},destroy:{name:"Destroy Spell",desc:"Plays when a destroy spell targets a minion.",icon:"ğŸ’¥",color:"#6b7280"},spell:{name:"Spell Cast",desc:"Plays on attack buffs and other spell effects.",icon:"ğŸ”®",color:"#8b5cf6"}};let p=null;function M(){return p||(p=new(window.AudioContext||window.webkitAudioContext)),p}async function B(t,e,n){const a=t.getContext("2d"),s=t.width=t.offsetWidth*window.devicePixelRatio,l=t.height=t.offsetHeight*window.devicePixelRatio;a.clearRect(0,0,s,l);try{const o=await(await fetch(e)).arrayBuffer(),r=(await M().decodeAudioData(o)).getChannelData(0),u=Math.max(1,Math.floor(r.length/s));a.fillStyle=n+"99",a.strokeStyle=n,a.lineWidth=1;const v=l/2;a.beginPath();for(let f=0;f<s;f++){const y=f*u,$=r.slice(y,y+u).reduce((I,L)=>Math.max(I,Math.abs(L)),0)*v*.95;a.moveTo(f,v-$),a.lineTo(f,v+$)}a.stroke()}catch{a.strokeStyle=n+"55",a.lineWidth=1,a.beginPath(),a.moveTo(0,l/2),a.lineTo(s,l/2),a.stroke()}}function x(t){return t<1024?t+" B":t<1024*1024?(t/1024).toFixed(1)+" KB":(t/1024/1024).toFixed(1)+" MB"}function P(t){const e=t.split(",")[1]??"";return Math.round(e.length*.75)}function T(t){const e=g[t],n=c.getCustomInfo()[t],a=n.hasCustom,s=n.volume,l=document.createElement("div");return l.className="slot-card",l.style.setProperty("--accent",e.color),l.dataset.key=t,l.innerHTML=`
    <div class="slot-header">
      <div class="slot-icon" style="background:${e.color}22;color:${e.color}">${e.icon}</div>
      <div>
        <div class="slot-name">${e.name}</div>
        <div class="slot-desc">${e.desc}</div>
      </div>
      <span class="status-tag ${a?"status-custom":"status-builtin"}" id="status-${t}">
        ${a?"Custom":"Built-in"}
      </span>
    </div>

    <div class="drop-zone ${a?"has-file":""}" id="drop-${t}" title="Click or drag an audio file here">
      <input type="file" accept="audio/*" id="file-${t}" />
      <div class="drop-icon">${a?"ğŸµ":"â¬†ï¸"}</div>
      <div id="drop-label-${t}">${a?S(t):"Drop audio file here or click to browse"}</div>
      <div class="file-info" id="file-info-${t}">${a?x(P(stored)):""}</div>
    </div>

    <div class="waveform-wrap" id="wave-wrap-${t}" style="${a?"":"display:none"}">
      <canvas class="waveform" id="wave-${t}"></canvas>
    </div>

    <div class="controls">
      <button class="btn-test" data-key="${t}">â–¶ Test</button>
      <button class="btn-clear" data-key="${t}" style="${a?"":"display:none"}" id="clear-${t}">ğŸ—‘ Clear</button>
      <span class="vol-label">Vol</span>
      <input type="range" min="0" max="1" step="0.01"
             value="${s}" id="vol-${t}" style="accent-color:${e.color}" />
      <span class="vol-display" id="vol-val-${t}">${Math.round(s*100)}%</span>
    </div>`,a&&requestAnimationFrame(()=>{var d;const i=l.querySelector(`#wave-${t}`),o=((d=c.getCustomInfo()[t])==null?void 0:d.dataUrl)??null;i&&o&&B(i,o,e.color)}),l}function S(t){var e;return((e=c.getCustomInfo()[t])==null?void 0:e.fname)??"Custom file"}function D(t){const e=t.dataset.key,n=t.querySelector(`#drop-${e}`),a=t.querySelector(`#file-${e}`);n.addEventListener("dragover",o=>{o.preventDefault(),n.classList.add("drag-over")}),n.addEventListener("dragleave",()=>n.classList.remove("drag-over")),n.addEventListener("drop",o=>{o.preventDefault(),n.classList.remove("drag-over");const d=o.dataTransfer.files[0];d&&C(e,d)}),a.addEventListener("change",()=>{const o=a.files[0];o&&C(e,o)}),t.querySelector(".btn-test").addEventListener("click",()=>c.play(e));const s=t.querySelector(`#clear-${e}`);s&&s.addEventListener("click",async()=>{await c.clearCustom(e),w(e,!1)});const l=t.querySelector(`#vol-${e}`),i=t.querySelector(`#vol-val-${e}`);l.addEventListener("input",()=>{const o=parseFloat(l.value);i.textContent=Math.round(o*100)+"%",c.setKeyVolume(e,o)})}async function C(t,e){const n=g[t],a=new FileReader;a.onload=async s=>{var o;const l=s.target.result,i=parseFloat(((o=document.getElementById(`vol-${t}`))==null?void 0:o.value)??"1");await c.setCustom(t,l,i,e.name),w(t,!0,{name:e.name,size:e.size,dataUrl:l,color:n.color})},a.readAsDataURL(e)}function w(t,e,n={}){const a=g[t],s=document.getElementById(`drop-${t}`),l=document.getElementById(`drop-label-${t}`),i=document.getElementById(`file-info-${t}`),o=document.getElementById(`wave-wrap-${t}`),d=document.getElementById(`wave-${t}`),m=document.getElementById(`clear-${t}`),r=document.getElementById(`status-${t}`),u=s==null?void 0:s.querySelector(".drop-icon");e?(s==null||s.classList.add("has-file"),u&&(u.textContent="ğŸµ"),l&&(l.textContent=n.name??S(t)),i&&(i.textContent=n.size?x(n.size):""),o&&(o.style.display=""),d&&n.dataUrl&&B(d,n.dataUrl,n.color??a.color),m&&(m.style.display=""),r&&(r.textContent="Custom",r.className="status-tag status-custom")):(s==null||s.classList.remove("has-file"),u&&(u.textContent="â¬†ï¸"),l&&(l.textContent="Drop audio file here or click to browse"),i&&(i.textContent=""),o&&(o.style.display="none"),m&&(m.style.display="none"),r&&(r.textContent="Built-in",r.className="status-tag status-builtin"))}const b=document.getElementById("masterVol"),A=document.getElementById("masterVolVal"),E=document.getElementById("muteBtn"),U=document.getElementById("clearAllBtn");b.addEventListener("input",()=>{const t=parseFloat(b.value);A.textContent=Math.round(t*100)+"%",c.setVolume(t)});E.addEventListener("click",()=>{const t=c.isMuted;c.mute(!t),E.textContent=t?"ğŸ”‡ Mute":"ğŸ”Š Unmute"});U.addEventListener("click",async()=>{confirm("Remove all custom sounds and revert to built-in?")&&(await Promise.all(h.map(t=>c.clearCustom(t))),h.forEach(t=>w(t,!1)))});(async()=>{await c.loadAllCustom();const t=document.getElementById("grid");for(const e of h){const n=T(e);t.appendChild(n),D(n)}})();
